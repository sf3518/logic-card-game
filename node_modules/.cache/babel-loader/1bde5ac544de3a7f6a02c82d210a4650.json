{"ast":null,"code":"import _slicedToArray from\"/Users/johnny/IC/Computing/year2/DRP/drp48/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useState}from\"react\";import Dialog from\"@material-ui/core/Dialog/Dialog\";import DialogTitle from\"@material-ui/core/DialogTitle/DialogTitle\";import DialogContent from\"@material-ui/core/DialogContent/DialogContent\";import TextField from\"@material-ui/core/TextField/TextField\";import MButton from\"@material-ui/core/Button\";import DialogActions from\"@material-ui/core/DialogActions/DialogActions\";import Grid from\"@material-ui/core/Grid/Grid\";import{userService}from\"../../services/user.service\";import{LoginContext}from\"../../LoginContext\";import{Divider,LinearProgress}from\"@material-ui/core\";export var LoginDialogue=function LoginDialogue(_ref){var open=_ref.open,onClose=_ref.onClose,onSwitchToLogin=_ref.onSwitchToSignup;var logins=useContext(LoginContext);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isUsernameValid=_useState2[0],setUsernameValid=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),username=_useState4[0],setUsername=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isPasswordValid=_useState6[0],setPasswordValid=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),password=_useState8[0],setPassword=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isLoading=_useState10[0],setLoading=_useState10[1];var _useState11=useState(true),_useState12=_slicedToArray(_useState11,2),isFirstTime=_useState12[0],setFirstTime=_useState12[1];var checkUsername=function checkUsername(){var ok=username.length>=2&&username.length<=50&&!username.includes(\";\");setUsernameValid(ok);return ok;};var checkPassword=function checkPassword(){var ok=password.length>=4;setPasswordValid(ok);return ok;};var submit=function submit(){if(checkUsername()&&checkPassword()){setLoading(true);userService.login(username,password,logins.toggleSetUser,function(){return alert(\"login error\");}).then(function(res){if(res){setLoading(false);onClose();}else{setLoading(false);}});}setFirstTime(false);};return/*#__PURE__*/React.createElement(Dialog,{open:open,onClose:onClose,\"aria-labelledby\":\"form-dialog-title\",maxWidth:\"xs\",PaperProps:{style:{backgroundColor:\"rgba(255, 255, 255, .70)\",boxShadow:\"inset 0 0 1rem 0 rgba(0, 0, 0, .2)\",borderRadius:\"5px\",backdropFilter:\"blur(7px)\"}}},/*#__PURE__*/React.createElement(DialogTitle,{id:\"form-dialog-title\"},\"Login\"),/*#__PURE__*/React.createElement(DialogContent,null,/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(TextField,{required:true,id:\"standard-required\",label:\"Username\",onChange:function onChange(event){return setUsername(event.target.value);},error:!isUsernameValid&&!isFirstTime,helperText:isUsernameValid||isFirstTime?\"\":\"Username must contain 2 ~ 50 valid characters\"})),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(TextField,{required:true,id:\"standard-password-input\",label:\"Password\",type:\"password\",autoComplete:\"current-password\",onChange:function onChange(event){return setPassword(event.target.value);},error:!isPasswordValid&&!isFirstTime,helperText:isUsernameValid||isFirstTime?\"\":\"Password must contain more than 4 characters\"})),/*#__PURE__*/React.createElement(\"div\",{style:{textAlign:\"right\",marginTop:\"10px\"}},/*#__PURE__*/React.createElement(MButton,{style:{width:\"100%\",backgroundColor:\"green\",color:\"white\"},onClick:submit},\"SUBMIT\")),/*#__PURE__*/React.createElement(\"div\",null,isLoading&&/*#__PURE__*/React.createElement(LinearProgress,null))),/*#__PURE__*/React.createElement(Divider,null),/*#__PURE__*/React.createElement(DialogActions,null,/*#__PURE__*/React.createElement(Grid,{container:true,style:{justifyItems:\"center\",alignItems:\"center\"}},/*#__PURE__*/React.createElement(Grid,{item:true,xs:9},/*#__PURE__*/React.createElement(\"span\",null,\"Don't have an account?\")),/*#__PURE__*/React.createElement(Grid,{item:true,xs:3},/*#__PURE__*/React.createElement(MButton,{onClick:onSwitchToLogin,style:{height:\"100%\"}},\"Sign-up\")))));};","map":{"version":3,"sources":["/Users/johnny/IC/Computing/year2/DRP/drp48/src/components/auth/Login.tsx"],"names":["React","useContext","useState","Dialog","DialogTitle","DialogContent","TextField","MButton","DialogActions","Grid","userService","LoginContext","Divider","LinearProgress","LoginDialogue","open","onClose","onSwitchToLogin","onSwitchToSignup","logins","isUsernameValid","setUsernameValid","username","setUsername","isPasswordValid","setPasswordValid","password","setPassword","isLoading","setLoading","isFirstTime","setFirstTime","checkUsername","ok","length","includes","checkPassword","submit","login","toggleSetUser","alert","then","res","style","backgroundColor","boxShadow","borderRadius","backdropFilter","event","target","value","textAlign","marginTop","width","color","justifyItems","alignItems","height"],"mappings":"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","sourcesContent":["import React, { useContext, useState } from \"react\";\nimport Dialog from \"@material-ui/core/Dialog/Dialog\";\nimport DialogTitle from \"@material-ui/core/DialogTitle/DialogTitle\";\nimport DialogContent from \"@material-ui/core/DialogContent/DialogContent\";\nimport TextField from \"@material-ui/core/TextField/TextField\";\nimport MButton from \"@material-ui/core/Button\";\nimport DialogActions from \"@material-ui/core/DialogActions/DialogActions\";\nimport Grid from \"@material-ui/core/Grid/Grid\";\nimport { userService } from \"../../services/user.service\";\nimport { LoginContext } from \"../../LoginContext\";\nimport { Divider, LinearProgress } from \"@material-ui/core\";\n\ninterface LoginProps {\n  open: boolean;\n  onClose: () => void;\n  onSwitchToSignup: () => void;\n}\n\nexport const LoginDialogue = ({\n  open,\n  onClose,\n  onSwitchToSignup: onSwitchToLogin,\n}: LoginProps) => {\n  const logins = useContext(LoginContext);\n\n  const [isUsernameValid, setUsernameValid] = useState(false);\n  const [username, setUsername] = useState(\"\");\n  const [isPasswordValid, setPasswordValid] = useState(false);\n  const [password, setPassword] = useState(\"\");\n  const [isLoading, setLoading] = useState(false);\n  const [isFirstTime, setFirstTime] = useState(true);\n\n  const checkUsername = () => {\n    const ok =\n      username.length >= 2 && username.length <= 50 && !username.includes(\";\");\n    setUsernameValid(ok);\n    return ok;\n  };\n\n  const checkPassword = () => {\n    const ok = password.length >= 4;\n    setPasswordValid(ok);\n    return ok;\n  };\n\n  const submit = () => {\n    if (checkUsername() && checkPassword()) {\n      setLoading(true);\n      userService\n        .login(username, password, logins.toggleSetUser, () =>\n          alert(\"login error\")\n        )\n        .then((res) => {\n          if (res) {\n            setLoading(false);\n            onClose();\n          } else {\n            setLoading(false);\n          }\n        });\n    }\n    setFirstTime(false);\n  };\n\n  return (\n    <Dialog\n      open={open}\n      onClose={onClose}\n      aria-labelledby=\"form-dialog-title\"\n      maxWidth=\"xs\"\n      PaperProps={{\n        style: {\n          backgroundColor: \"rgba(255, 255, 255, .70)\",\n          boxShadow: \"inset 0 0 1rem 0 rgba(0, 0, 0, .2)\",\n          borderRadius: \"5px\",\n          backdropFilter: \"blur(7px)\",\n        },\n      }}\n    >\n      <DialogTitle id=\"form-dialog-title\">Login</DialogTitle>\n      <DialogContent>\n        <div>\n          <TextField\n            required\n            id=\"standard-required\"\n            label=\"Username\"\n            onChange={(event) => setUsername(event.target.value)}\n            error={!isUsernameValid && !isFirstTime}\n            helperText={\n              isUsernameValid || isFirstTime\n                ? \"\"\n                : \"Username must contain 2 ~ 50 valid characters\"\n            }\n          />\n        </div>\n\n        <div>\n          <TextField\n            required\n            id=\"standard-password-input\"\n            label=\"Password\"\n            type=\"password\"\n            autoComplete=\"current-password\"\n            onChange={(event) => setPassword(event.target.value)}\n            error={!isPasswordValid && !isFirstTime}\n            helperText={\n              isUsernameValid || isFirstTime\n                ? \"\"\n                : \"Password must contain more than 4 characters\"\n            }\n          />\n        </div>\n        <div style={{ textAlign: \"right\", marginTop: \"10px\" }}>\n          <MButton\n            style={{ width: \"100%\", backgroundColor: \"green\", color: \"white\" }}\n            onClick={submit}\n          >\n            SUBMIT\n          </MButton>\n        </div>\n        <div>{isLoading && <LinearProgress />}</div>\n      </DialogContent>\n      <Divider />\n      <DialogActions>\n        <Grid\n          container\n          style={{ justifyItems: \"center\", alignItems: \"center\" }}\n        >\n          <Grid item xs={9}>\n            <span>Don't have an account?</span>\n          </Grid>\n          <Grid item xs={3}>\n            <MButton onClick={onSwitchToLogin} style={{ height: \"100%\" }}>\n              Sign-up\n            </MButton>\n          </Grid>\n        </Grid>\n      </DialogActions>\n    </Dialog>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}